插值问题指要求插值曲线严格经过控制点，拟合问题不要求拟合曲线严格过控制点。
实际运用中，插值曲线用于生成符合要求的曲线，拟合曲线用于去噪与对实验曲线建模。
### 拉格朗日插值

$$
f(x)=\sum\limits_{i=0}^{n}y_{k}\prod_{j\neq i}{\displaystyle (x-x_{j})\over\displaystyle(x_{i}-x_{j})}
$$
特殊的，若  $x_{0},...,x_{n}$ 等距分布，则求一次插值时，基函数的值可以递推求出，时间复杂度为 $O(n)$。
### 牛顿插值

给定横坐标值互不相等的 $n+1$ 组点 $(x_{0},y_{0}),...,(x_{n},y_{n})$，定义 $n$ 阶差商（也称均差）为
$$
f[x_{0},...,x_{n}] ={f[x_{0},...,x_{n-1}]-f[x_{1},...,x_{n}]\over x_{0}-x_n}={f[x_{0},...,x_{n-1}]-f[x_{0},...,x_{n-2},x_{n}]\over x_{x_{n-1}}-x_n}
$$
由归纳法可知，$n$ 阶差商的这两种定义是等价的。
同样由归纳法知，$n$ 阶差商是排列对称的，$x_{0},...,x_{n}$ 的顺序不改变其 $n$ 阶差商的值。

牛顿插值多项式，是 $n$ 阶多项式，它的基函数为
$$
w_{0}(x)=1,\quad w_k(x)=\prod_{i=0}^{k-1}(x-x_i)
$$
表达式为
$$
f(x)=\sum\limits_{k=0}^{n}w_{k}(x)f[x_0,...,x_k]
$$
同样利用归纳法可以证明 $f(x_{k})=y_{k}(0\le k\le n)$。
对于给定的 $n+1$ 组点，计算牛顿插值多项式系数的时间复杂度是 $O(n^{2})$，求一次插值的时间复杂度是 $O(n)$。

当给 $n+1$ 组点添加一个新点 $(x_{n+1},y_{n+1})$ 时，根据已求出的系数，求出 $f[x_{0},...,x_{n+1}]$ 需要 $O(n)$ 的时间复杂度。

当 $x_{0},...,x_{n}$ 是 $nh$ 的等距分布时
$$
f[x_{0},...,x_{k}]={\Delta^{k}f(x_{0})\over k! h^k}
$$
其中 $\Delta^{k}$ 是 $k$ 阶差分。

差商的近似为
$$
f[x_{0},...,x_{n}]={f^{(n)}(\xi)\over n!}\quad(\exists\xi\in[x_{0},x_{n}])
$$
其中 $x_{0}<x_{1}<...<x_{n}$。
由此可看出，泰勒多项式是牛顿多项式的极限（$x_{k}\to x_{0}(1\le k\le n)$）。

**优点**
不管如何选择 $x_{0},...,x_{n}$，单次拟合的复杂度为 $O(n)$，而不是拉格朗日插值的 $O(n^{2})$。
实际上，对于同一组点，拉格朗日插值多项式与牛顿插值多项式是同一多项式，只是计算方式不同而已。

**总结**
牛顿插值的差商有以下性质
（1）排序不变性
（2）等距分布时与差分的关系
（3）差商近似

### 诶尔米特（$\text{Hermite})$插值

给定 $n+1$ 组点 $(x_{0},y_{0}),...,(x_{n},y_{n})$ 和对应 $1$ 到 $m$ 阶导数 $y^{(k)}_{0},...,y^{(k)}_{n}$，则在对应点满足对应导数值的多项式称作诶尔米特插值多项式，显然其至多 $(m+1)(n+1)-1$ 次。

当 $m=1$ 时，有公式
$$
\begin{gather}
H(x)=\sum\limits_{i=0}^{n}\left(y_{i}+(x-x_{i})\left(y'_{i}-2y_{i}\sum\limits_{j\neq i}{1\over x_{i}-x_{j}}\right)\right)\prod_{j\neq i}{(x-x_{j})^{2}\over (x_{i}-x_{j})^{2}}\\
\end{gather}
$$

它的二阶导数有特殊性质
$$

$$

当 $n=1,m=1$ 时，有公式
$$
\begin{aligned}
H(x)&=\sum\limits_{i=0}^{1}\left[\alpha_{i}(x)y_{i}+\beta_{i}(x)y'_{i}
\right]\\
\alpha_{i}(x)&=\left(1-{2(x-x_{i})\over x_{i}-x_{1-i}}\right)\left({x-x_{1-i}\over x_{i}-x_{1-i}}\right)^{2}\\
\beta_{i}(x)&=(x-x_{i})\left({x-x_{1-i}\over x_{i}-x_{1-i}}\right)^{2}
\end{aligned}
$$

当 $x_{0},...,x_{n}$ 等距分布时，求一次插值的复杂度为 $O(n)$。

实际应用时，可以结合分段插值与诶尔米特插值，即三次样条插值，兼具光滑性与较好精度。

### 样条插值

设有 $n+1$ 个节点 $a=x_{0}<x_{1}<...<x_{n}=b$ 以及节点值 $y_{k}$，则 $\left\{x_{0},...,x_{n}\right\}$ 上的**三次样条函数** $S(x)$ 为 $C^{2}[a,b]$，满足
（1）$S(x)$ 在 $\Delta x_{k}=[x_{k},x_{k+1}]$ 上是三次函数 $(0\le k\le n-1)$。
（2）$S(x_{k})=y_{k}\quad(0\le k\le n)$
（3）$S(x)$ 在内节点 $\left\{x_{1},...,x_{n-1}\right\}$ 上的一阶、二阶导数连续。

当附加上如下三类边界条件之一时，$S(x)$ 唯一
（1）已知两段一阶导数值 $S'(x_{0}),S'(x_{n})$
（2）二阶 $S''(x_{0}),S''(x_{n})$。特别的，在 $S''(x_{0})=S''(x_{n})=0$ 时，该条件被称为**自然边界条件**
（3）周期条件 $y_{0}=y_{n},S'(x_{0})=S'(x_{n}),S''(x_{0})=S''(x_{n})$。

求解 $S(x)$ 的一种简便方式是用 $M_{j}=S''(x_{j})$ 表示 $S(x)$，在 $h_{j}=\Delta x_{j} (0\le j\le n-1)$ 上 $S''(x)$ 是线性函数
$$
S''(x)=M_{j}{x_{j+1}-x\over h_{j}}+M_{j+1}{x-x_{j}\over h_j}
$$
利用 $S(x_{j})=y_{j},S(x_{j+1})=y_{j+1}$， 可解得
$$
\begin{gather}
S(x)=M_{j}{(x_{j+1}-x)^{3}\over 6h_{j}}+M_{j+1}{(x-x_{j})^{3}\over 6h_{j}}+\left(y_{j}-{M_{j}h_{j}^{2}\over6}\right){x_{j+1}-x\over h_{j}}+\left(y_{j+1}-{M_{j+1}h_{j+1}^{2}\over6}\right){x-x_{j}\over h_{j}}\\
\end{gather}
$$
于是对 $0\le j\le n-1$ 有
$$
\begin{gather}
S'(x_{j}+0)=-{h_{j}\over3}M_{j}-{h_{j}\over6}M_{j+1}+{y_{j+1}-y_{j}\over h_{j}}\\
S'(x_{j}-0)={h_{j-1}\over 6}M_{j-1}+{h_{j-1}\over3}M_{j}+{y_{j}-y_{j-1}\over h_{j-1}}
\end{gather}
$$
故对 $M_{1},...,M_{n-1}$ 有方程
$$
\begin{gather}
\mu_{j}M_{j-1}+2M_{j}+\lambda_{j}M_{j+1}=d_{j}\\
\mu_{j}={h_{j-1}\over h_{j-1}+h_{j}},\lambda_{j}={h_{j-1}\over h_{j}+h_{j}},d_{j}=6f[x_{j-1},x_{j},x_{j+1}]
\end{gather}

$$
再由边界条件得出关于 $M_{0},M_{n}$ 的方程，可以求出 $M_{0},...,M_{n}$。
（1）
$$

$$

（2）另 $\mu_{0}=\lambda_{0}=0,d_{0}=2S''(x_{0}),d_{n}=2S''(x_{n})$，则线性方程组同（1）类似

（3）


