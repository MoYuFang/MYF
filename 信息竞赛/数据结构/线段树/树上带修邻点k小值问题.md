给定一颗 $n$ 个节点的树，每个点 $u$ 上有一个权值 $a_u$，你需要完成以下任务。

1. 给出点 $u$ 和排名 $k$，求与 $u$ 相邻的所有点中的第 $k$ 小权值。
2. 给出点 $u$ 和数值 $val$，将 $a_u$ 修改为 $val$。

数据范围 $1\le k\le n\le 5\times 10^5,\ 1\le a_u\le 5\times 10^5$，任务总数 $m\le 5\times 10^5$。

#### 题解

先任选根将无根树变成有根树，对每个点用动态开点的权值线段树维护每个子节点的权值。

修改某节点时需要在它的父亲上更新，$O(\log n)$。

查询时首先现在权值线段树中求出第 $k$ 小的值 $x$，若这个点的父亲的权值 $<x$ 则说明相邻点中第 $k$ 小值是权值线段树中的第 $k-1$ 小值，否则 $x$ 就是答案，$O(\log n)$。