### 题目描述

对于某字符串 $s$，定义 $s_{l,r}$ 为 $s$ 中第 $l$ 到第 $r$ 个字符组成的子串。

给定单词集 $T$ 和一个字符串 $S$，$t_i$ 为 $T$ 中第 $i$ 个单词， $S$ 中的每个位置 $i$ 上有一个权值 $a_i$。 

对于两个字符串 $s$，它的长度为 $|s|$，若存在 $p$ 使得子串 $S_{p-|s|+1,p}$ 就是 $s$，则称 $s$ 在 $S$ 的第 $p$ 个位置上出现，且 $s$ 得到权值奖励 $a_r$.

对于 $S$ 的某子串 $S_{l,r}$，定义 $s$ 在 $S_{l,r}$ 中的价值为 $s$ 在 $S_{l,r}$ 得到的权值奖励之和。

有 $q$ 次询问，每次询问 $S_{l,r}$ 中 $t_i$ 的价值。

### 题目输入

首行三个整数 $n,m,q$，分别代表 $S$ 的长度，$T$ 的大小和询问的总数。

下面一行，一个字符串，代表 $S$。

下面一行，$n$ 个整数，第 $i$ 个整数代表 $a_i$。

下面 $m$ 行，每行一个字符串，其中第 $i$ 行的字符串代表 $t_i$。

下面 $q$ 行，每行三个整数 $l,r,i$，代表一次询问的参数。

### 题目输出

对于每次查询，输出一行一个整数。

### 数据范围

$ 10 \leq n,m,q, \leq 5\times 10^5,\ \ \sum|t_i| \leq 5\times 10^5,\ \ 1\leq l\leq r\leq n,\ \ 1\leq i\leq m,\ \ 1\leq a_i \leq 10^9$

保证 $S$ 和 $t_i$ 中只含小写字母。

### 题解

 $\text{AC}$ 自动机 + 线段树合并。

将所有询问离线，分别挂在 $\text{AC}$ 自动机上对应的节点。

用 $\text{AC}$ 自动机匹配 $S$，设现在匹配到了第 $i$ 个字符，在 $\text{AC}$ 自动机上走到了状态 $u$，则在 $u$ 上留下标记 $i$。

匹配完 $S$ 后 $dfs$ 失配树，用线段树合并来合并标记，然后回答查询。