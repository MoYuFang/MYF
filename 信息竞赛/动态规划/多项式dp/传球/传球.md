### 题目描述

有 $n$ 个人站成一个圈，每个人有 $a_i$ 个球，下面要进行一次操作：

每个人把一些它的球交给它左边的人，所有人同时进行。

完了过后每个人有 $b_i$ 个球，记这个序列为 $B$。

对于每个 $B$，它的价值为 $\prod b_i$。

两个 $B$ 不同，仅当存在某人向左传的球数不一样。

对于所有 $B$，你要计算它们的价值和，对 $10^9+7$ 取模。

### 题目输入

首行一个 $n$，代表人数。

接下来一行 $n$ 个整数，代表 $a_i$。

### 题目输出

一行一个整数，为价值和。

### 数据范围

$1\leq n\leq 10^6,\ \ 1\leq a_i < 10^9+7$

### 题解

直接 $\text{dp}$ 有些难，不妨断环成链，设第 $1$ 个人向左（第 $n$ 个人）传了 $t$ 个球。

设 $f(i,x)$ 表示当前考虑到了第 $i$ 个人，第 $i$ 个人向左传了 $x$ 个球时的价值和，此时 $b_1$ 到 $b_{(i-1)}$ 就确定了，前 $i-1$ 人对价值和的贡献就确定了，$f(i,x)$ 就表示了已经确定的价值和，显然有以下转移式：
$$
f(i,x)=\sum_{y=0}^{a_{(i-1)}} f(i-1, y)\cdot(a_{(i-1)}+x-y)
$$
边界条件为：
$$
f(1,t)=1\\
f(1,x) = 0\quad(x\neq t)
$$
答案为：
$$
ans = \sum_{t=0}^{a_1}\sum_{x=0}^{a_n} f(n,x)\cdot(a_n+t-x)
$$
这个 $\text{dp}$ 不够优秀，考虑优化它。

设：
$$
w(k,x) = \sum_{i=0}^{x}i^k\\
g(i)=\sum_{x=0}^{a_i} f(i,x)\\
h(i)=\sum_{x=0}^{a_i} f(i,x)\cdot x
$$
这里认为 $0^0=1$。

则原 $\text{dp}$ 的转移式化为：
$$
f(i,x)=(a_{(i-1)}+x)\cdot g(i-1)-h(i-1)\\
g(i)=w(0,a_i)\cdot a_{(i-1)}\cdot g(i-1)+w(1,a_i)\cdot g(i-1) + w(0,a_i)\cdot h(i-1)\\
h(i)=w(1,a_i)\cdot a_{(i-1)}\cdot g(i-1)+w(2,a_i)\cdot g(i-1) + w(1,a_i)\cdot h(i-1)
$$
边界条件化为：
$$
g(1)=1\\
h(1)=t
$$
答案化为：
$$
ans=\sum_{t=0}^{a_1}((a_n+t)\cdot g(n) - h(n))
$$
仔细观察 $\text{dp}$ 转移式和答案表达式，可以发现转移是线性的，所有 $g$ 和 $h$ 都是关于 $t$ 的一次多项式（$g(1)=1$ 除外），而答案表达式是关于 $t$ 的二次多项式的自然数幂求和。

于是可以将 $\text{dp}$ 看成是对一次多项式的转移，最后算个自然数幂求和即可。