设一个二分图分为 $X = \{x_i|1\leq i \leq n\}$​​ 和 $Y = \{y_i|1\leq i \leq m\}$​​​​ ，则有完美匹配的充要条件是对于 $X$ 的子集 $S_x$ 存在 $Y$ 的子集 $S_y$ 满足 $S_y$ 中的任意点均与 $S_x$​ 中某点相连且 $|S_y| >= |S_x|$。 



#### BZOJ 1135 [POI2009]Lyz

#### 题目描述

初始时滑冰俱乐部有 $1$​ 到 $n$​ 号的溜冰鞋各k双。已知x号脚的人可以穿 $x$​ 到 $x+d$​ 的溜冰鞋。 有 $m$​ 次操作，每次包含两个数，$r_i$​，$x_i$​代表来了$x_i$​ 个 $r_i$​ 号脚的人。$x_i$​ 为负，则代表走了这么多人。 对于每次操作，输出溜冰鞋是否足够。

#### 输入

第一行$n$​​​，$m$​​​，$k$​​​，$d$​​​​ 四个整数 $(1≤n≤200,000,1≤m≤500,000,1≤k≤109,0≤d≤n)$​​​
接下来 $m$​​ 行，每行两个数 $r_i,x_i(1≤i≤m，1≤r_i≤n−d,|x_i|≤109)$​

#### 输出

对于每个操作，输出一行，```TAK``` 表示够 ```NIE``` 表示不够。

#### 样例输入

```
4 4 2 1
1 3
2 3
3 3
2 -1
```

#### 样例输出

```
TAK
TAK
NIE..
TAK
```

解：将每个人看作 $X$ ，每双鞋看作 $Y$ ，则有完美匹配的条件是：
$$
\forall 1\leq l \leq r \leq n-d\\
\sum_{i=l}^{r} a[i] \leq (r-l+1+d)\cdot k\\
\forall 1\le l\le n\\
\sum_{i=l}^{n}a[i]\le(n-l+1)k
$$
其中 $a[i]$​ 是每只型号的脚的人数。

等价于：
$$
\max_{1\leq l \leq r \leq n-d}\{ \sum_{i=l}^{r} (a[i]-k) \} \leq d\cdot k\\
\max_{1\leq l\leq n}\sum_{i=l}^{n}(a[i]-k)\le0
$$
于是可以通过用线段树维护动态最大子段和以及最大后缀和即可得出答案。

