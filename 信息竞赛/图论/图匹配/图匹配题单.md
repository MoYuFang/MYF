### 二分匹配

#### $\text{DAG}$ 的最小路径覆盖

二分匹配可以用来求 $\text{DAG}$ 的最小路径覆盖，方法是将 DAG 上每个点 $u$ 拆成出点 $u_o$ 和入点 $u_i$， $\text{DAG}$ 上一的一条有向边 $(u,v)$ 在二分图上是一条无向边 $(u_o, v_i)$。则 $\text{DAG}$ 的最小链路覆盖的链数等于 $\text{DAG}$ 的总点数 $n$ 减去二分图的最大匹配数 $pch$，即 $n-pch$。



### 一般图的最大匹配

[P6113 【模板】一般图最大匹配](https://www.luogu.com.cn/problem/P6113) 模板题

[P4258 [WC2016] 挑战NPC](https://www.luogu.com.cn/problem/P4258) 每个框建一个三元环（三个相互连边的点）。每个球建一个点，若某个球可以投向某个框，则让这个球的点与框对应的三元环上的三个点均连一条边。答案为最大匹配数减去球数。然后还要构造方案，方法是跑完带花树算法后，对每个没匹配上的球进行一次特殊的 $\text{dfs}$，这个 $\text{dfs}$ 用来改变整张图的匹配情况，但不改变最大匹配数。

[hydro.ac_d_nsas_p85](..\..\..\题面\hydro.ac_d_nsas_p85.png) 首先用网络流排除杀不完敌人的情况， 然后建用来求最大匹配的图。

每个敌人建一个点。

每个盾建一个点，对其可以攻击的敌人的端点连上一条边。

每个基础生命值建一条有两个端点的边，每个端点均对该基础生命值可以攻击的敌人的端点连上一条边。

每个额外生命值建一条有两个端点的边，其中一个（任选）端点，对该额外生命值可以攻击的敌人的端点连上一条边。

可以断言，答案就是最大匹配数减去敌人总数。

[hydro.ac_d_nsas_p70](..\..\..\题面\hydro.ac_d_nsas_p70.png) 

每台电脑一个点。

每条网线一条双端点的边，每个端点均对该网线可连接的电脑的端点连一条边。

可以断言，答案是最大匹配数减去网线总数。



### 图匹配的应用

[[SEERC 2019]F.Game on tree](https://codeforces.com/group/wmhDiB5PTN/contest/472166/problem/F) 

[ICPC2022Nanjing-J.Perfect Matching](https://codeforces.com/group/wmhDiB5PTN/contest/469223/problem/J) $|i-j|=|a_i-a_j|$ 的条件可以拆成
$$
\begin{cases}
i-a_{i}=j-a_{j} \\
i+a_{i}=j+a_{j}
\end{cases}
$$
于是 $i-a_{i}$ 相等的点可以组成一个团，属于一类团，$i+a_{i}$ 也可，属于二类团，每个团可以看作一个新点，这两类组成一个二分图，这个图有且只有 $n$ 条边，第 $i$ 条边代表原图上的点 $i$，它连接了有 $i$ 在的一类团的对应新点 $u$ 与有 $i$ 在的二类团的对应新店。
考虑原图中 $i,j$ 有连边，当且仅当二分图中边 $i$ 与边 $j$ 有公共点。
二分图中一个连通块若有奇数条边，可知这个连块上的边在原图上的对应点们没有完美匹配。
有偶数条边时，将连通块按照从连通块中某一起点出发的 $\text{bfs}$ 分层，然后逐层贪心匹配，可以证明最终可构造出完美匹配。

