### SSP 算法

SSP（Successive Shortest Path）算法是一个贪心的算法。它的思路是每次寻找单位费用最小的增广路进行增广，直到图上不存在增广路为止。

如果图上存在单位费用为负的圈，SSP 算法无法正确求出该网络的最小费用最大流。此时需要先使用消圈算法消去图上的负圈。

正确性证明：

只需证明，当前残差网络 $G$（点和容量大于 $0$ 的边的集合）不存在负环但存在增广路时，增广后的新残差网络 $G'$ 一定不会出现负环。

设无负环且有增广路的残差网络 $G$ 的一条费用最小的增广路的路径是 $P:(p_{1},q_{1})\rightarrow ...\rightarrow (p_{n},q_{n})$，其逆反路径是 $P':(q_{n},p_{n})\rightarrow...\rightarrow(q_{1},p_{1})$。

反设 $G'$ 中出现了负环，不妨选取 $G'$ 中某个负环 $B$（负环可能有多个，后续证明会依据需要替换负环），则 $B$ 必然包含两类边（两类均不为空集），一类是 $P'$ 中的若干边，记为 $B_{1}$，一类是 $G$ 中 $P$ 以外的边 $B_{2}$，$B_2$ 同时也是 $G'$ 中 $P'$ 以外的边。

进一步对 $B_{1}$ 进行分类讨论：

若 $B_{1}$ 是 $P'$ 中一段连续的路径 $P'[r,l]:(q_{r},p_{r})\rightarrow...\rightarrow(q_{l},p_{l})$，根据负环的性质可得
$$
\sum\limits_{e\in B_{2}}cost(e)<-\sum\limits_{i\in[l,r]}cost(q_{i},p_{i})=\sum\limits_{i\in[l,r]}cost(p_{i},q_{i})
$$
也就说，我们在 $G$ 中找到了一条费用比 $cost(P)$ 更小的增广路，即 $B_{2}$ 和 $P-P[l,r]$ 组成的增广路，矛盾。

 若 $B_{1}$ 由 $P'$ 中若干间断的部分组成，即 
 $$
 B_{1}=\bigcup_{i=1}^{m}P'[r_{i},l_{i}]
$$

因为间断，所以一定有 $l_{i}>r_{i-1}\quad(i\in[2,m])$。

$B_{1}$ 中间断的部分必然由 $B_{2}$ 中的子部分连接起来，记 $B_{2}[l_{i}-1,r_{i-1}+1]$ 是 $B_{2}$ 中将 $P'[r_{i},l_{i}]$ 和 $P'[r_{i-1},l_{i-1}]$ 连接起来的部分（$i\in[2,m]$）。

对 $P'[l_{i}-1,r_{i-1}+1]$ 与 $B_{2}[l_{i}-1,r_{i-1}+1]$ 的花费做比较

若 $cost(P'[l_{i}-1,r_{i-1}+1])\le cost(B_{2}[l_{i}-1,r_{i-1}+1])$，如果用 $P'[l_{i}-1,r_{i-1}+1]$ 替换 $B$ 中的 $B_{2}[l_{i}-1,r_{i-1}+1]$，得到的新环 $B'$ 的花费一定不大于 $cost(B)$，那么在选取 $G'$ 中的负环这一步时，可以选取 $B'$ 以规避这种情况。

所以必有 $cost(P'[l_{i}-1,r_{i-1}+1])>cost(B_{2}[l_{i}-1,r_{i-1}+1])$，也即
$$
cost(P[l_{i}-1,r_{i-1}+1])+cost(B_{2}[l_{i}-1,r_{i-1}+1])<0
$$
这说明 $G$ 中出现了负环，这与 $G$ 无负环的前提矛盾。

综合对 $B_{1}$ 两种情况的均导致矛盾的讨论，可知 $G'$ 中一定不存在负环，所以 $\text{SSP}$ 算法是正确的。




