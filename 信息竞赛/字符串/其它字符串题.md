[[2023ICPCAsiaOnlineContestOne]H.Range Periodicity Query](..\题面\[2023ICPCAsiaOnlineContestOne]H.Range Periodicity Query.png) 对于一个周期长度 $p$ 来说，如果它不是 $S_k$ 的周期，那么它一定不是 $S_{k+1}$ 的周期，因此可以二分出分界线 $t_p$ 满足它是 $S_p,S_{p+1},...,S_{t_p}$ 的周期，但不是 $S_{t_p+1}$ 的周期。对于一个询问 $(k,l,r)$ ，问题等价于寻找区间中数值最小的数，满足它的 $t$ 值至少为 $k$ 。将所有询问按 $k$ 从大到小排序，并将所有周期按 $t$ 值从大到小排序，用线段树支持单点修改、区间查询最小值即可。