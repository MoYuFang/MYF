$(1)$ $\text{dp}$

$(2)$ 生成函数

$(3)$ 容斥

$(4)$ 斯特林数

$(5)$ 转换题目。

将题目的条件或操作等价转换为若干更简单、更便于计数的形式。

$(6)$ 递推。

一些计数问题具有分形结构，可以使用递推。

**6.1** 统计两个长度为 $n$、元素范围为 $\{1,...,m\}$ 的数列 $a,b$ 的方案数，满足对任意 $1\le i<j\le n$ 有 $\min\{a_i,b_j\}=\min\{a_j,b_i\}$。

记答案为 $f_{n,m}$。对于一个长度为 $n$ 的合法方案，设其 $2n$ 个数中最小的元素为 $x$，若 $x$ 的对应元素 $y >x$，则可以推出 $x$ 所在的那一个数列必定全为 $x$，另一个数列除了 $y$ 以外可以为 $\ge x$  的任何数。否则所有 $x$ 的对应元素均为 $x$，假设 $(x,x)$ 有 $i(0\le i\le n)$ 対，则剩下 $2n-2i$ 个数必定 $>x$，而剩下 $n-i$ 长度的方案数等价于 $f_{n-i,m-x}$。

于是一种分最小元素是否为 $1$ 的递推公式就出来了
$$
f_{n,m}=2m^n-2+\sum_{i=0}^nf_{n-i,m}{n\choose i}
$$
利用指数生成函数计算后可以得到
$$
f_{n,m}=2m^{n+1}-2\sum_{i=1}^mi^n+m^n
$$
**6.2** 求将 $n$ 分解成 $2$ 的幂次之和的方案数。

相当于个数无限且物品重量均为 $2$ 的幂次的多重背包，因为物品个数为 $\log n$，使用 naive 的背包可以做到 $O(n\log n)$。

记答案为 $f_n$，做以下分类讨论。

当 $n$ 为奇数时，至少使用一个 $2^0$，所以 $f_n=f_{n-1}$。

当 $n$ 为偶数时，或者使用 $2^0$ ，或者不使用，所以 $f_n=f_{n-1}+f_{n/2}$。

这是 $O(n)$ 的递推。

**6.3** 计算 $n$ 的分拆数。

除了利用多项式求 $exp$ 的 $O(n\log n)$ 做法，还有一种根号分治的做法。

记 $T=\sqrt{n}$，考虑分别算出仅使用小于 $T$ 的物品且求和为 $i$ 的数组 $f_i$，以及仅使用大于等于 $T$ 且求和为 $i$ 的数组 $g_i$，$f$ 与 $g$ 这两个数组一卷积就是答案了。

$f$ 可以用多重背包以 $O(n\sqrt{n})$ 求出。

为求 $g$ ，设 $g_{i,j}$ 为使用了 $j$ 个 $\ge T$ 的物品且求和为 $i$ 的方案数。对于 $g_{i,j}$，要么新加一个物品 $T$，要么给当前已收录的物品全体加一，所以 $g_{i,j}=g_{i-T,j-1}+g_{i-j,j}$。注意到 $j$ 的大小不超过 $\sqrt{n}$，所以 $g$ 也能够 $O(n\sqrt{n})$ 求出。



